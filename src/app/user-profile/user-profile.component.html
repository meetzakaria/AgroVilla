<div class="container mt-5">
  <div class="card shadow-lg p-4">
    <h3 class="text-center text-success mb-4">Customer Profile</h3>

    <!-- Profile View -->
    <div *ngIf="!editable">
      <div class="text-center mb-3">
        <img [src]="imagePreview || ('data:image/jpeg;base64,' + user.profileImage)" class="rounded-circle img-thumbnail" width="120" height="120" alt="Profile Image">
      </div>

      <table class="table table-bordered">
        <tr>
          <th>Name</th>
          <td>{{ user.name }}</td>
        </tr>
        <tr>
          <th>Email</th>
          <td>{{ user.email }}</td>
        </tr>
        <tr>
          <th>Phone</th>
          <td>{{ user.phone }}</td>
        </tr>
        <tr>
          <th>Address</th>
          <td>{{ user.address }}</td>
        </tr>
      </table>

      <div class="text-end">
        <button class="btn btn-primary" (click)="enableEdit()">Edit Profile</button>
      </div>
    </div>

    <!-- Profile Edit Form -->
    <form *ngIf="editable" (ngSubmit)="saveChanges()">
      <div class="row mb-3">
        <div class="col-md-4 text-center">
          <img [src]="imagePreview || ('data:image/jpeg;base64,' + user.profileImage)" class="rounded-circle img-thumbnail mb-2" width="120" height="120" alt="Profile Image">
          <input type="file" class="form-control" (change)="onImageChange($event)">
        </div>
        <div class="col-md-8">
          <div class="form-group mb-2">
            <label>Name</label>
            <input [(ngModel)]="user.name" name="name" class="form-control" required>
          </div>
          <div class="form-group mb-2">
            <label>Email</label>
            <input [(ngModel)]="user.email" name="email" class="form-control" required>
          </div>
          <div class="form-group mb-2">
            <label>Phone</label>
            <input [(ngModel)]="user.phone" name="phone" class="form-control">
          </div>
          <div class="form-group mb-2">
            <label>Address</label>
            <input [(ngModel)]="user.address" name="address" class="form-control">
          </div>
        </div>
      </div>

      <div class="text-end">
        <button type="submit" class="btn btn-success me-2">Save</button>
        <button type="button" class="btn btn-secondary" (click)="cancelEdit()">Cancel</button>
      </div>
    </form>

    <!-- Password Change Section -->
    <hr class="my-4">
    <h5 class="text-center text-warning mb-3">Change Password</h5>
    <form (ngSubmit)="changePassword()" class="col-md-6 offset-md-3">
      <div class="form-group mb-3">
        <input type="password" [(ngModel)]="passwordChange.oldPassword" name="oldPassword" class="form-control" placeholder="Old Password" required>
      </div>
      <div class="form-group mb-3">
        <input type="password" [(ngModel)]="passwordChange.newPassword" name="newPassword" class="form-control" placeholder="New Password" required>
      </div>
      <button class="btn btn-warning w-100" type="submit">Update Password</button>
    </form>
  </div>
</div>
